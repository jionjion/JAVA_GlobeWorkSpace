<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- SeckillDao接口的SQL映射 -->
<mapper namespace="dao.SeckillDao">
	
	<!-- 减库存 -->
	<update id="reduceNumber">
		update seckill set number = number -1 
		where seckill_id = #{seckillId} 
		and start_time <![CDATA[<=]]>  #{killTime}
		and end_time >= #{killTie}
		and number > 0;
	</update>
	
	<!-- 查询秒杀商品 -->
	<select id="queryById" resultType="Seckill" parameterType="long">
		select seckill_id , name , start_time , create_time from seckill
		where seckill_id = #{seckill_id};
	</select>
	
	<!-- 分页查询全部 -->
	<select id="queryAll">
		select seckill_id , name , start_time , create_time from seckill
		order by create_time desc
		limit #{offset}, #{limit};
	</select>
	
</mapper>    