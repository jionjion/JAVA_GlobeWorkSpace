package javaEail.until;

import java.util.Properties;

import javax.mail.Authenticator;
import javax.mail.Message;
import javax.mail.MessagingException;
import javax.mail.PasswordAuthentication;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.AddressException;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMessage.RecipientType;

/**邮件的工具类*/
public class EmailUntil {

	/**将发件人的Email地址传进去,以及UUD传入,完成验证*/
	public static void sendEmail(String to ,String code) {
		
		//创建连接对象
		//创建配置服务信息
		//QQ邮箱的令牌  lulyxaugngsfhhad
		Properties props = new Properties();
		props.put("mail.transport.protocol", "smtp");
		props.put("mail.smtp.host", "smtp.qq.com");
		props.put("mail.smtp.port", "465");							//端口号
		props.put("mail.smtp.auth", "true");									//交由服务器进行用户验证
	    props.put("mail.smtp.timeout","25");							//超时时间
	    props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
	    props.put("mail.smtp.socketFactory.port", "465");
	    props.put("mail.smtp.ssl.enable", "true");
//	    props.setProperty("mail.debug", "true");
		Session session = Session.getInstance(props,new Authenticator() {
			@Override
			protected PasswordAuthentication getPasswordAuthentication() {
				return new PasswordAuthentication("1434501783@qq.com", "lulyxaugngsfhhad");
			}
		});
		//创建邮件对象
		Message message = new MimeMessage(session);
		try {
			message.setFrom(new InternetAddress("1434501783@qq.com"));			//发件人
			message.setRecipient(RecipientType.TO, new InternetAddress(to));	//发送类型,收件人	
			message.setSubject("主题:这是我的JAVA测试邮件");							//设置邮件主题
			String html = "	<h1>你好,很高兴认识你</hi><p>您的UUID为:"+code+"</p>";		//设置邮件内容
			message.setContent(html, "text/html;charset=UTF-8");				//设置邮件文本格式
			
		//发送邮件
			Transport.send(message);
		} catch (Exception e) {
			System.err.println("创建邮件服务发生意外.....");
			e.printStackTrace();
		}
		
		
	}
}
